<Window x:Class="AppTaskManager.Views.TasksViewMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AppTaskManager.Views"
        xmlns:uc="clr-namespace:AppTaskManager.Views.UserControllers" 
        mc:Ignorable="d"
        Title="Менеджер задач" Height="800" Width="1400"
        MinHeight="450" MinWidth="1170"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Storyboard x:Key="SlideOnLoad">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="0.0" To="1.0"
                             Duration="0:0:2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <ThicknessAnimation Storyboard.TargetProperty="Margin"
                                From="0 800 0 0" To="0 0 0 0"
                                Duration="0:0:1">
                <ThicknessAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="80" />
            <ColumnDefinition Width="435" />
            <ColumnDefinition Width="1*" />
            <ColumnDefinition Width="200" />
        </Grid.ColumnDefinitions>

        <!--Navigation panel-->
        <Rectangle Fill="{StaticResource AccentDark}" Grid.Column="0"/>
        <StackPanel Grid.Column="0" Margin="10 15 10 10">
            <Button Style="{StaticResource NavigationButton}">
                <Viewbox Width="30" Height="30">
                    <Path Data="{StaticResource ListIcon}" Fill="{StaticResource OnAccent}"/>
                </Viewbox>
            </Button>
        </StackPanel>

        <!--Task List Background-->
        <Rectangle Fill="{StaticResource TaskListBackground}" 
                   Grid.Column="1"/>
        <!--Task List Grid-->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="70" />
                <RowDefinition Height="40" />
                <RowDefinition Height="1*" />
            </Grid.RowDefinitions>
            <!--Task Label-->
            <Label Content="Задачи" 
                   Style="{StaticResource Header1}"
                   VerticalAlignment="Center"
                   Padding="20 0 0 0"
                   IsHitTestVisible="False"
                   Grid.Row="0"/>
            
            <!--Add New Task button-->
            <Button Style="{StaticResource RoundAccentButton}"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Height="40"
                    Width="40"
                    Margin="0 0 20 0"
                    Command="{Binding IOpenNewWindow}">
                <!--New Task Icon-->
                <Viewbox Width="20" Height="30">
                    <Path Data="{StaticResource NewTaskIcon}" Fill="{StaticResource OnAccent}"/>
                </Viewbox>
            </Button>

            <!--SearchBox-->
            <TextBox x:Name="TaskSearchBox" Grid.Row="1"
                     Style="{StaticResource TaskListSearchBox}"
                     Margin="20 0"
                     Text="{Binding SearchTitle}"/>
            <Label IsHitTestVisible="False" 
                   Content="Поиск задачи..."
                   Grid.Row="1"
                   VerticalAlignment="Center"
                   Margin="40 0 0 0"
                   Foreground="{StaticResource Borders}"
                   Visibility="{Binding Text.IsEmpty, ElementName=TaskSearchBox, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            <Button Grid.Row="1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Margin="0 0 30 0"
                    Padding="10"
                    Background="White"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                    Style="{StaticResource SearchButton}"
                    Height="30"
                    Width="30"
                    Command="{Binding IFindTasks}">
                <Viewbox Width="20" Height="20">
                    <Path Data="{StaticResource SearchIcon}" Fill="{StaticResource Borders}"/>
                </Viewbox>
            </Button>

            <!--List View For Task Items-->
            <ListView x:Name="TaskListView"
                      Grid.Row="2"
                      Background="Transparent"
                      Margin="0 20"
                      BorderBrush="Transparent"
                      ItemsSource="{Binding TaskModels}"
                      SelectedItem="{Binding SelectedTask}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <uc:TaskItemView Height="145" Width="400" Background="WhiteSmoke"/>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>

        <!--Task Viewer-->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="230"/>
                <RowDefinition Height="1*"/>
                <RowDefinition Height="60"/>
            </Grid.RowDefinitions>
            <!--Task Details-->
            <Grid Margin="20 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="60"/>
                    <RowDefinition Height="1*"/>
                    <RowDefinition Height="30"/>
                </Grid.RowDefinitions>
                <!--Task Title-->
                <TextBlock 
                    Text="{Binding SelectedTask.Title}" 
                    Style="{StaticResource Title}" 
                    VerticalAlignment="Center"/>
                <!--Importance Badge-->
                <Border HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Padding="20 5"
                        Background="{Binding TaskImportance, Converter={StaticResource ColorConverter}}"
                        CornerRadius="5">
                    <TextBlock Text="{Binding SelectedTask.TaskImportance, Converter={StaticResource EnumDescriptionConverter}}"
                               Foreground="WhiteSmoke"
                               FontWeight="DemiBold"
                               FontSize="16"/>
                </Border>

                <!--Description Scroll Viewer-->
                <ScrollViewer Grid.Row="1"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled">
                    <!--Description-->
                    <TextBlock  
                           Text="{Binding SelectedTask.Description}"
                           FontSize="16"
                           Foreground="{StaticResource PlaceholderText}"
                           Margin="0 20"/>
                </ScrollViewer>
                <!--Due Date-->
                <TextBlock Text="{Binding SelectedTask.EndTime}"
                           Background="{StaticResource AccentDark}"
                           Padding="20 3"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Left"
                           Grid.Row="2"
                           Foreground="White"/>
            </Grid>
            <Grid Grid.Row="1" Margin="0 20 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="50"/>
                    <RowDefinition Height="1*"/>
                </Grid.RowDefinitions>
                <!--List Title-->
                <TextBlock Style="{StaticResource Title}"
                           Text="Контроль выполнения"
                           VerticalAlignment="Center"
                           Margin="20 0 0 0"/>
                <!--Check Lists-->
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition Height="40"/>
                    </Grid.RowDefinitions>
                <ListView Grid.Row="0"
                          Background="Transparent"
                          BorderThickness="0"
                          Margin="0 20 0 0"
                          ItemsSource="{Binding SelectedTask.TaskChecks}"
                          SelectedItem="{Binding SelectedCheck}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                                <CheckBox IsEnabled="{Binding IsComplete, Converter={StaticResource CheckBoxEnabledConverter}}"
                                          IsChecked="{Binding IsComplete, Mode=TwoWay}"
                                          Content="{Binding Description}"
                                          Margin="5"
                                          FontSize="14"/>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
                    <Button Grid.Row="1"  Content="Подтвердить изменение контроля"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontWeight="DemiBold"
                            Style="{StaticResource TaskViewCompleteButton}"
                            Margin="0 0 10 0"
                            Command="{Binding ISaveChanges}"/>
                </Grid>
            </Grid>
            <!--Task View Buttons-->
            <Grid Grid.Row="2">
                <Button Content="Удалить"
                        HorizontalContentAlignment="Center"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        FontWeight="DemiBold"
                        Style="{StaticResource TaskViewDeleteButton}"
                        Margin="10 0 0 0"
                        Command="{Binding DeleteTaskCommand}"/>
                <Button Content="Редактировать"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontWeight="DemiBold"
                        Style="{StaticResource TaskViewEditButton}"
                        Command="{Binding IOpenEditTask}"/>
                <Button Content="Выполнено"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        FontWeight="DemiBold"
                        Style="{StaticResource TaskViewCompleteButton}"
                        Margin="0 0 10 0"
                        Command="{Binding ICompletedCommand}"/>
            </Grid>
        </Grid>

        <!--Task Status Bar-->
        <Rectangle Fill="{StaticResource TaskStatusBackground}" Grid.Column="3"/>
        <!--Task Status-->
        <Grid Grid.Column="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="230"/>
                <RowDefinition Height="1*"/>
                <RowDefinition Height="140"/>
            </Grid.RowDefinitions>
            <Calendar Grid.Row="0" HorizontalAlignment="Center" Margin="20" VerticalAlignment="Top" Width="174"/>
            <ListView Grid.Row="1">
                <!--Выборка ближайших к исполнению задач-->
            </ListView>
        </Grid>
    </Grid>
</Window>
